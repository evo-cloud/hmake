<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> &middot; HyperMake</title>

    <meta name="description" content="">

    <meta name="generator" content="Hugo 0.16" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content=" &middot; HyperMake">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content=" &middot; HyperMake">
    <meta property="og:description" content="">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="http://evo-cloud.github.com/hmake//css/syntax-highlighter.css">
    <link rel="stylesheet" href="http://evo-cloud.github.com/hmake//css/blog.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="HyperMake" href="http://evo-cloud.github.com/hmake//index.xml" />
</head>
<body>
<div class="banner pure-u-1 pure-u-md-1-4">
    <div class="banner-title">
        <h1 class="brand-title"><a href="http://evo-cloud.github.com/hmake/">HyperMake</a></h1>
        <h2 class="brand-tagline"> build without pre-requisites </h2>
    </div>
    <div class="banner-links">
        <nav class="nav">
            <ul class="nav-list">
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/evo-cloud/hmake "><i class="fa fa-github-alt"></i><span> github</span></a>
                </li>
                
                
            </ul>
        </nav>
    </div>
</div>


<div id="layout" class="pure-g">
    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
<section class="post">
    <header class="post-header">

        <a href="http://evo-cloud.github.com/hmake/docs/QuickStart/" class="post-title"></a>

        <p class="post-meta">
            
            
        </p>
    </header>
    
    <div class="post-description">
        

<h1 id="quick-start-guide">Quick Start Guide</h1>

<p>This is a guide to write a HyperMake file for your project for the first time.</p>

<h2 id="before-start">Before Start</h2>

<p>You need a project, of course. Let&rsquo;s make a simple <em>Hello World</em> C++ project,
and see how HyperMake can help.</p>

<p>Here&rsquo;s the project directory layout:</p>

<pre><code>ProjectRoot
  |
  +--inc/
  +--src/
      +--hello.cpp
</code></pre>

<p>In <code>hello.cpp</code>:</p>

<pre><code class="language-cpp">#include &lt;iostream&gt;

int main(int argc, char *argv[]) {
    std::cout &lt;&lt; &quot;Hello World!&quot; &lt;&lt; std::endl;
    return 0;
}
</code></pre>

<p>To build it, use <code>g++ -o hello src/hello.cpp</code>. You will need toolchain installed.
Now, let&rsquo;s create a <code>HyperMake</code> to simplify the build.</p>

<h2 id="create-hypermake">Create <code>HyperMake</code></h2>

<p><code>HyperMake</code> can be composed in two ways:</p>

<ul>
<li>Wrapper mode: which wraps existing build tools, like GNU make</li>
<li>Full mode: the native HyperMake format with all features.</li>
</ul>

<p>For <em>Wrapper mode</em>, read details in <a href="/hmake/docs/WrapperMode/">Wrapper Mode</a>.
In this guide, we will use <em>Full mode</em>.</p>

<p>Create a file called <code>HyperMake</code> under <code>ProjectRoot</code>.
It&rsquo;s a <em>YAML</em> file, so let&rsquo;s start with:</p>

<pre><code class="language-yaml">---
format: hypermake.v0
name: hello
description: The Hello World Project
</code></pre>

<p>The first line <code>---</code> is optional but recommended, as YAML parser will treat it
as the beginning of a new document.</p>

<p><code>format</code> is required and must be assigned with <code>hypermake.v0</code>.
<em>hmake</em> only parses YAML files with <code>format: hypermake.v0</code>.
<code>name</code> specifies the project name, which is required.
<code>description</code> gives more information about the project. It&rsquo;s optional.</p>

<h2 id="adding-targets">Adding targets</h2>

<p>The most important part is the section defining targets:</p>

<pre><code class="language-yaml">---
format: hypermake.v0
name: hello
description: The Hello World Project

targets:
  build:
    description: build hello binary
    image: 'gcc:4.9'
    cmds:
      - g++ -o hello src/hello.cpp
</code></pre>

<p>We defined one target above: <code>build</code>. It has three properties:</p>

<ul>
<li><code>description</code>: a brief intro about what the target does;</li>
<li><code>image</code>: the docker image used to create the container and run commands;</li>
<li><code>cmds</code>: a list of commands to execute inside the container.</li>
</ul>

<p>Now, we can use <code>hmake build</code> to build the project, and type</p>

<pre><code>./hello
</code></pre>

<p>to show <code>Hello World</code>.</p>

<p>Under the hood, <code>hmake</code> creates a container temporarily, and maps current project
root to <code>/src</code> inside container and run the commands inside the container.</p>

<p>Are you feeling boring type <code>hmake build</code> every time? Why not just <code>hmake</code>?
Let&rsquo;s move on with default targets.</p>

<h2 id="settings">Settings</h2>

<p>The default targets can be specified inside <code>settings</code> section:</p>

<pre><code class="language-yaml">---
format: hypermake.v0
name: hello
description: The Hello World Project

targets:
  build:
    description: build hello binary
    image: 'gcc:4.9'
    cmds:
      - g++ -o hello src/hello.cpp

settings:
  default-targets:
    - build
</code></pre>

<p>With <code>default-targets</code> specified in <code>settings</code>, we can type <code>hmake</code> without
arguments and it will run targets defined in <code>default-targets</code>.</p>

<p>The <code>settings</code> section defines properties which are common to all targets.
For example, we can define common properties for <code>docker</code>. Let&rsquo;s move <code>image</code>
property to settings:</p>

<pre><code class="language-yaml">---
format: hypermake.v0
name: hello
description: The Hello World Project

targets:
  build:
    description: build hello binary
    cmds:
      - g++ -o hello src/hello.cpp

settings:
  default-targets:
    - build
  docker:
    image: 'gcc:4.9'
</code></pre>

<p>As we moved <code>image</code> to <code>settings/docker</code>, we can remove <code>images</code> from target
<code>build</code>. And all targets will have <code>image: 'gcc:4.9'</code> by default.</p>

<h2 id="watches-and-artifacts">Watches and Artifacts</h2>

<p>Let&rsquo;s do some tricks here: <code>touch src/hello.cpp</code> or modify the file, and then
type <code>hmake</code>. You will see the <code>build</code> target is skipped:</p>

<pre><code>HyperMake v1.1.0 https://github.com/evo-cloud/hmake

=&gt; build 21:56:42.277
:] build
╔══════╤═══════╤════════╤════════════╤════════════╤═════╗
║Target│Result │Duration│Start       │Finish      │Error║
╠══════╪═══════╪════════╪════════════╪════════════╪═════╣
║build │Skipped│        │21:56:42.277│21:56:42.277│     ║
╚══════╧═══════╧════════╧════════════╧════════════╧═════╝
OK
</code></pre>

<p>This is definitely not what we want. The problem is <em>hmake</em> doesn&rsquo;t know which
files are input and which are output. Let&rsquo;s tell <em>hmake</em> by adding <code>watches</code> and
<code>artifacts</code> to target <code>build</code>:</p>

<pre><code class="language-yaml">targets:
  build:
    description: build hello binary
    watches:
      - inc
      - src
    cmds:
      - g++ -o hello src/hello.cpp
    artifacts:
      - hello
</code></pre>

<p>The items in <code>watches</code> can be a path to a directory or a file, or with wildcards
matching a list of files/directories. If the item is a directory, all sub-directories
and files are watched recursively.
<code>artifacts</code> lists the output files. <em>hmake</em> rebuilds the target if any of the
artifacts is missing. Wildcard is not allowed here, and directory is not matched
recursively.</p>

<p>Some targets doesn&rsquo;t require input files or generate output files. In this case
command line options can be used to explicitly rebuild the target: <code>-R</code>, <code>-r</code>, or
<code>-b</code>. See <a href="/hmake/docs/CommandLine/">Command Line</a> for details.</p>

<h2 id="dependencies">Dependencies</h2>

<p>As the project is so simple that we can use an existing docker image <code>gcc:4.9</code> which
contains toolchain we need.
However in most cases, the existing docker images are not always good enough, and
we want to install extra bits to build the project.
Then we need to build our own toolchain image.</p>

<p>Let&rsquo;s use <code>cmake</code> to build our project, by adding <code>CMakeList.txt</code> under project root:</p>

<pre><code>cmake_minimum_required(VERSION 2.8.0)
project(hello CXX)
include_directories(&quot;inc&quot;)
add_executable(hello src/hello.cpp)
</code></pre>

<p>Then we will need <code>cmake</code> in toolchain image, let&rsquo;s build one based on <code>gcc:4.9</code>.
Create a folder <code>toolchain</code> under project root and put a <code>Dockerfile</code> inside it:</p>

<pre><code>FROM gcc:4.9
RUN apt-get update &amp;&amp; apt-get install -y cmake &amp;&amp; apt-get clean
</code></pre>

<p>And update <code>HyperMake</code>:</p>

<pre><code class="language-yaml">---
format: hypermake.v0
name: hello
description: The Hello World Project

targets:
  toolchain:
    description: build our own toolchain image
    watches:
      - toolchain
    build: toolchain

  build:
    description: build hello binary
    after:
      - toolchain
    watches:
      - inc
      - src
    cmds:
      - rm -fr rel &amp;&amp; mkdir -p rel
      - cd rel &amp;&amp; cmake .. &amp;&amp; make
    artifacts:
      - rel/hello

settings:
  default-targets:
    - build
  docker:
    image: 'cmake-gcc:4.9'
</code></pre>

<p>Target <code>toolchain</code> is added, with property <code>build</code>, <em>hmake</em> knows to build a
docker image, using <code>toolchain/Dockerfile</code>. And as <code>image: cmake-gcc:4.9</code> is specified
in <code>settings</code>, the built image will be <code>cmake-gcc:4.9</code>.</p>

<p>In target <code>build</code>, <code>after</code> specifies <code>toolchain</code> must succeed before <code>build</code> is able
to run. Because <code>build</code> will use the image <code>cmake-gcc:4.9</code> generated by <code>toolchain</code>.</p>

<p>Now, type <code>hmake</code> and it will first run <code>toolchain</code> to build <code>cmake-gcc:4.9</code> and
the run <code>build</code> to call <code>cmake</code> to build the binary.</p>

<h2 id="more">More</h2>

<p>The above covers the basic features of <em>HyperMake</em>.
There are a lot more useful features.
Please read documents listed in <a href="/hmake/README/">README</a> for more details, and take
a look at <code>examples</code> for real samples.</p>

    </div>
    
</section>

            </div>
            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Pages generated by <a class="hugo" href="https://gohugo.io/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="http://evo-cloud.github.com/hmake//js/jquery.min.js"></script>
<script src="http://evo-cloud.github.com/hmake//js/jquery.prettysocial.min.js"></script>
<script src="http://evo-cloud.github.com/hmake//js/rainbow-custom.min.js"></script>
<script src="http://evo-cloud.github.com/hmake//js/scripts.js"></script>

        </div>
    </div>
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        
        
        
        <hgroup>
            <h1 class="brand-title"><a href="https://github.com/evo-cloud/hmake/releases">Releases</a></h1>
            
            <h2 class="brand-tagline">
                <a href="https://github.com/evo-cloud/hmake/releases/tag/v1.3.0">1.3.0</a>
            </h2>
            
        </hgroup>
        
        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/evo-cloud/hmake/releases/download/v1.3.0/hmake-linux-amd64.tar.gz">
                        <i class="os fa fa-linux"></i>
                        <span>linux</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/evo-cloud/hmake/releases/download/v1.3.0/hmake-darwin-amd64.tar.gz">
                        <i class="os fa fa-apple"></i>
                        <span>Mac OS X</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/evo-cloud/hmake/releases/download/v1.3.0/hmake-windows-amd64.zip">
                        <i class="os fa fa-windows"></i>
                        <span>windows</span>
                    </a>
                </li>
                
            </ul>
        </nav>
        
    </div>
</div>

</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
